<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>CloudPlugin by dorugucea91</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">CloudPlugin</h1>
      <h2 class="project-tagline">Cloud Services Plugin for ImageJ - Gsoc 2015</h2>
      <a href="https://github.com/dorugucea91/CloudPlugin" class="btn">View on GitHub</a>
      <a href="https://github.com/dorugucea91/CloudPlugin/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/dorugucea91/CloudPlugin/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="developers" class="anchor" href="#developers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Developers</h1>

<p>Student: <a href="gucea.doru@gmail.com">Doru-Cristian Gucea</a><br>
Mentor1: <a href="dimiterpp@gmail.com">Dimiter Prodanov</a><br>
Mentor2: <a href="visakh@incf.org">Visakh Muraleedharan</a>   </p>

<h1>
<a id="organization" class="anchor" href="#organization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Organization:</h1>

<p><a href="http://incf.org">International Neuroinformatics Coordinating Facility</a>   </p>

<h1>
<a id="project-description" class="anchor" href="#project-description" aria-hidden="true"><span class="octicon octicon-link"></span></a>Project description</h1>

<p>ImageJ is a public domain Java image processing program designed with an open architecture that provides extensibility via Java plugins. The aim of this project is to develop an ImageJ plugin which can be used to download/upload datasets from/to iRODS (Integrated Rule-Oriented Data System), an open source data management software used by the research community in order to take control of their data, regardless of where and on what device the data is stored</p>

<h3>
<a id="re-factoring" class="anchor" href="#re-factoring" aria-hidden="true"><span class="octicon octicon-link"></span></a>Re-factoring</h3>

<p>My project is forked from Atin's repository: <a href="https://github.com/Atin007/dbclient">https://github.com/Atin007/dbclient</a>, which is a GSoc 2014 project. Atin's project implements an ImageJ plugin for Dropbox, so I thought that it would be appropriate to integrate my new iRODS functionality as another cloud service.<br>
A lot of re-factoring was done to the old project in order to make it clear and easier to support for future developers. The problems with the coding style from the Gsoc 2014's project was that (quote from the project proposal belonging to Desmond, Joshua A.): </p>

<blockquote>
<p>The current project is nothing short of a mess, with a thorough lack of documentation, an
absence of automated JUnit tests, and a strong disregard for object oriented design principles. The
program admittedly works as it should, but from a software design perspective, it is unusable. In one
of the two classes within the entire program, for example, there is a method called “run” that is over
1000 lines long, (or, according to a SLOC counter, about 550 lines without comments). The method
“run” encapsulates building the GUI and its every component, defining all action listeners in their
entirety with anonymous class definitions, managing multiple threads, handling data validation from
Dropbox, making numerous calls to Swing, Dropbox, AWT, and ImageJ libraries, building and
representing the file tree from Dropbox, determining the operating system of the user, and probably
If anyone ever wants to build off or further develop MyCloudJ, refactoring is a must. No
further work could possibly get around that.
Before starting to implement the functionality for iRODS, a lot of refactoring work was done. This work also continued while adding iRODS features. I will present the re-factoring challenges in this separate chapter, trying to isolate the presentation of the functionality from the presentation of the re-factoring. Stay tunned!</p>
</blockquote>

<h3>
<a id="week-1" class="anchor" href="#week-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Week 1</h3>

<p><u>Deliverable:</u> Plugin with a simple GUI, asking for iRODS credentials. The plugin can create a session with the iRODS server and display a successful/not successful connection message.  </p>

<p>As can be observed from the below picture, I kept the GUI from Atin's project and modified just the login box, by providing the user with text inputs for entering the credentials. The user can switch between Dropbox and iRODS login using a Radio Button.</p>

<p>iRODS Login Screen<img src="images/screen_login_irods.png"></a></p>

<p>Code implementing the login part can be found in the login method from the rods_backend package. Every cloud plugin should implement a login method and that's the reason for making the login method an operation in the CloudOperations interface. </p>

<pre><code>
import org.irods.jargon.core.connection.IRODSAccount;
import org.irods.jargon.core.connection.IRODSProtocolManager;
import org.irods.jargon.core.connection.IRODSSession;
import org.irods.jargon.core.connection.IRODSSimpleProtocolManager;
import org.irods.jargon.core.exception.JargonException;
import org.irods.jargon.core.pub.IRODSAccessObjectFactory;
import org.irods.jargon.core.pub.IRODSAccessObjectFactoryImpl;
import org.irods.jargon.core.pub.io.IRODSFile;

public void login() throws CloudException {    
	String error;    
	IRODSProtocolManager connectionManager;   
	IRODSAccount account;   
	IRODSAccessObjectFactory accessObjectFactory;

	try {
		connectionManager = IRODSSimpleProtocolManager.instance();
		session = IRODSSession.instance(connectionManager);
		account = new IRODSAccount(host, port, user, password,
				homeDirectoryPath, zone, res);
		accessObjectFactory = IRODSAccessObjectFactoryImpl
				.instance(session);
		irodsFileFactory = accessObjectFactory.getIRODSFileFactory(account);

		buildHomePath();
		userIsLogged = true;
	} catch (JargonException e) {
		error = "Error login to iRODS";
		throw (new CloudException(error));
	}
}
</code></pre>

<p>As can be seen from the imports used,  the communication with the iRODS server was done using the <a href="https://github.com/DICE-UNC/jargon">Jargon API</a>, version 4.0.2.1. I created a jar (jargon-core-4.0.2.1-SNAPSHOT-jar-with-dependencies.jar) with the Jargon functionality and placed it in the libs folder fro  then I linked my project against this jar.
A detailed explanation with all the fields used for the connection can be found <a href="https://github.com/DICE-UNC/jargon/wiki/Managing-connections">here</a>, but the field that we are intersted in is <i>irodsFileFactory</i>. This is the handler which will be used for reading/writing iRODS files from the cloud server. </p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/dorugucea91/CloudPlugin">CloudPlugin</a> is maintained by <a href="https://github.com/dorugucea91">dorugucea91</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

